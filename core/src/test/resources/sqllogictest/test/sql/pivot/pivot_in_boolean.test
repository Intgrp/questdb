# name: test/sql/pivot/pivot_in_boolean.test
# description: Issue #8596 - Pivot with IN clause doesn't work for a boolean column
# group: [pivot]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE Cities(Country VARCHAR, Name VARCHAR, Year INT, Population INT);

statement ok
INSERT INTO Cities VALUES ('NL', 'Amsterdam', 2000, 1005);

statement ok
INSERT INTO Cities VALUES ('NL', 'Amsterdam', 2010, 1065);

statement ok
INSERT INTO Cities VALUES ('NL', 'Amsterdam', 2020, 1158);

statement ok
INSERT INTO Cities VALUES ('US', 'Seattle', 2000, 564);

statement ok
INSERT INTO Cities VALUES ('US', 'Seattle', 2010, 608);

statement ok
INSERT INTO Cities VALUES ('US', 'Seattle', 2020, 738);

statement ok
INSERT INTO Cities VALUES ('US', 'New York City', 2000, 8015);

statement ok
INSERT INTO Cities VALUES ('US', 'New York City', 2010, 8175);

statement ok
INSERT INTO Cities VALUES ('US', 'New York City', 2020, 8772);

# pivot cities on (Country='NL') using avg(Population) group by name;
# todo(nwoolmer): add aliasing in for so we can have
# # Cities PIVOT (avg(population) FOR Country IN ('US' as 'false', 'NL' as 'true') GROUP BY name);
query III rowsort

SELECT name, US as 'false', NL as 'true' FROM (
  Cities PIVOT (
    avg(population)
    FOR Country IN ('US', 'NL')
    GROUP BY name
    ORDER BY name
  )
);
----
Amsterdam NULL 1076.000000
New York City 8320.666667 NULL
Seattle	636.666667 NULL

# pivot cities on (Country='NL') in (false, true) using avg(Population) group by name;
# we aren't dynamic, so this is identical to the prior case
query III rowsort
SELECT name, US as 'false', NL as 'true' FROM (
  Cities PIVOT (
    avg(population)
    FOR Country IN ('US', 'NL')
    GROUP BY name
    ORDER BY name
  )
);
----
Amsterdam NULL 1076.000000
New York City 8320.666667 NULL
Seattle	636.666667 NULL